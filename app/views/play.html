<div ng-class="['level-'+level, tuto ? 'tuto' : '']">

	<div class="windows">
		<div  ng-repeat="(id, win) in windows"
					id="{{id}}"
					kendo-window="{{id}}"
					k-title="win.title"
					k-on-open="win.visible = true"
					k-on-close="win.visible = false"
					k-resizable="win.resizable"
					k-actions="win.actions"
					k-modal="win.modal"
					k-visible="win.visible"
					k-position="win.position"
					k-width="win.width"
					k-height="win.height"
					k-content="{url: '/views/_'+win.template+'.html'}">
		</div>
	</div>

	<ul id="windows-bar">
		<li ng-repeat="(id, win) in windows" ng-if="win.active" ng-class="[id, win.visible ? 'visible' : '']">
			<button class="k-button"
					ng-click="toggleWin(id)">
				{{win.title}}
			</button>
		</li>
	</ul>

	<div class="widgets">
		<div class="timeline">
			<div class="clearfix timeline-row">
				<h2 class="left">Temps restant</h2>
				<a ng-click="endDay()" class="endDay bt bt--finish right">Terminer la journée</a>
			</div>
			<div class="clearfix">
				<div class="gauge left">
					<div ng-class="['gauge__inner', gaugeLevel]">
						<div class="fill" style="width:{{100-((totalTime-remainingTime)/totalTime)*100}}%;"></div>
					</div>
				</div>
				<span class="remaining left">{{remainingTime | duration}}</span>
			</div>
		</div>

		<div class="feedback feedback--{{feedback.type}}" ng-if="feedback.active">
			<div class="feedback__title">
				{{feedback.status}}
			</div>
			<p class="feedback__body">{{feedback.detail}}</p>
		</div>
	</div>

	<div id="tooltip" ng-show="tooltip.active">
		<p ng-bind-html="tooltip.content"></p>
	</div>

	<div id="scoring" ng-class="[level, status]" ng-if="showScoring">
		<div class="inner-content">
			<div class="scoring__body scoring__body--{{scoreStatus}}">

				<div ng-if="scoreStatus=='victory'">
					<h2 class="scoring__title">Victoire</h2>
					<h3 class="scoring__subtitle">Félicitations</h3>
					<p ng-if="level===2">
  						Vous avez appris les bases de l'utilisation de Cuicuitter pour chercher des infos<br />
						et savoir de quoi elles parlent. Mais la route est encore longue avant de devenir<br />
						un journaliste chevronné. Maintenant les choses sérieuses vont commencer !
					</p>
					<p ng-if="level===3">
						Bravo ! Vous êtes vigilant : avec vous, pas question de publier n’importe quoi ! <br />
						Vous commencez à être un journaliste confirmé. Mais si vous êtiez aux commandes, sauriez-vous détecter les scoops et choisir quelles infos mettre en avant sur votre site ?
 					</p>
					<button ng-click="nextLevel()" class="bt bt--nextlevel">Niveau Suivant</button>
				</div>
				<div ng-if="scoreStatus=='defeat'">
					<h2 class="scoring__title">Défaite</h2>
					<h3 class="scoring__subtitle">Manque de rigueur !</h3>
					<p>Retentez votre chance pour accéder au niveau suivant !</p>
				</div>

				<div class="scores" ng-if="scoring['level-'+level]['winning-score']">
					<ul class="clearfix unstyled score__list">
						<li class="score__item">
							<span class="score__item__body">Score à atteindre <br />pour ce niveau</span>
							<span class="score__item__result">{{scoring['level-'+level]['winning-score']}}</span>
						</li>
						<li class="score__item score__item__currentlevel">
							<span class="score__item__body">Mon score <br />pour ce niveau</span>
							<span class="score__item__result">{{scores['level-'+level]}}</span>
						</li>
						<li class="score__item score__item__alllevel">
							<span class="score__item__body">Mon score <br />total</span>
							<span class="score__item__result">{{scores['level-1']+scores['level-2']+scores['level-3']+scores['level-4']}}</span>
						</li>
					</ul>

					<button class="bt bt--nextlevel" ng-if="scoreStatus=='defeat'" ng-click="playAgain()">Recommencer</button>

					<h2 class="scoring__title scoring__title--details">Détail du score</h2>
					<ul class="scoring__details unstyled">

						<li class="scoring__details__item cuit visible" ng-repeat="post in posts">
							<div class="inner">
								<div class="inner__body">
									<div class="media">
										<img ng-src="/images/avatars/{{post.cuit.author.id|removeAT}}.png" alt="" class="avatar">
										<div class="media">
											<p>
												<a href="" ng-click="openSource(cuit.author.id)" class="source ng-binding">
													{{post.cuit.author.id}}
												</a>
											</p>
											<p class="ng-binding">
												{{post.cuit.content}}
											</p>
										</div>
									</div>
								</div><!-- .inner__body -->
								<ul class="metas">
									<li class="theme">Thématique
										<span class="item-theme {{post.cuit.theme}}">{{post.cuit.theme}}</span>
									</li>
									<li class="credibility">Crédibilité <div class="stars stars--0">2</div></span></li>
									<li class="exclusivity">Scoop <div class="stars stars--0">3</div></li>
								</ul>
							</div>
							<div class="starburst"><span><span><span><span><span><span><span><span><strong>{{post.score}}</strong>pts</span></span></span></span></span></span></span></span></div>
						</li>

					</ul>
				</div>
			</div>
		</div>
	</div>

	</div>

</div>

<div id="debug" ng-include="'/views/_debug.html'" ng-if="debug||fast"></div>
